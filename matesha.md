* $n$ — число двоичных разрядов (бит) во входных множителях.
* $M(n)$ — **битовая** (схемная) сложность умножения двух $n$-разрядных целых в модели булевых схем / неветвящихся программ (straight‑line programs). Сложность — число элементарных логических/арифметических операций, глубина — параллельное время.&#x20;
* Центральная задача: эволюция $M(n)$ от «школьных» $\Theta(n^2)$ к современным $O(n\log n)$. Магистральный приём — **сведение к меньшим задачам через интерполяцию/свёртку**.&#x20;

---

## 1) Базовый («школьный») метод: $\Theta(n^2)$

Идея: один множитель умножают на каждый бит другого с соответствующим сдвигом и суммируют частичные произведения. Это даёт по порядку $n^2$ побитовых умножений и $(n-1)$ суммирований. **Аккуратная верхняя оценка** схемной сложности стандартного метода:

$$
6n^2-8n,
$$

а при использовании современных компрессоров — улучшение до

$$
5.5\,n^2-6.5\,n-1+(n\bmod 2).
$$

Эти уточнения важны для практики при малых $n$.&#x20;

---

## 2) Первый прорыв: метод Карацубы

Разбиение «пополам»: $A=A_1 2^n+A_0,\; B=B_1 2^n+B_0$. Вместо классической формулы

$$
AB=A_1B_1\cdot 2^{2n} + (A_0B_1+A_1B_0)\cdot 2^n + A_0B_0,
$$

Карацуба использует

$$
\boxed{\,AB=A_1B_1\cdot 2^{2n} + \big(A_1B_1 + A_0B_0 - (A_0-A_1)(B_0-B_1)\big)\cdot 2^{n} + A_0B_0,\,}
\tag{K}
$$

что требует **трёх** полупроизведений вместо четырёх и нескольких сложений/вычитаний. Рекуррентное неравенство

$$
K(2n)\le 3K(n)+O(n)
$$

по мастер‑теореме даёт

$$
\boxed{\,K(n)=O\!\big(n^{\log_2 3}\big)\approx O(n^{1.585})\,}.
$$

Идея за формулой (K) — интерполяция по значениям (для целых — скрыто через разбиения по степеням 2).&#x20;

---

## 3) Блочные методы 1960‑х: линия Тоома–Кука (для целых)

Разбиваем числа на $r$ блоков длины $q$:

$$
A=\sum_{i=0}^{r-1} A_i 2^{iq},\qquad B=\sum_{i=0}^{r-1} B_i 2^{iq},\qquad A_i,B_i<2^q.
\tag{T}
$$

Алгоритм строится как «оценка–перемножение–восстановление» для соответствующих полиномов и затем подстановка $X=2^q$ (для целых это лишь **способ свёртки блоков**). Для теоретической оценки берут растущий $r$ и получают субквадратику. Исторические верхние оценки:

$$
O\!\Big(\frac{n^2}{\sqrt{\log n}}\Big)\quad\text{(Тоом)};\qquad
O\!\Big(\frac{n^2}{\sqrt{2\log n}\,\log n}\Big)\quad\text{(уточнение Кнута).}
$$

На практике применяют малые $r$ (включая «Тоом‑3») вплоть до сотен–$\sim10^3$ бит.&#x20;

---

## 4) Дискретное преобразование Фурье (ДПФ) как язык свёртки

Пусть $K$ — коммутативное кольцо, $\zeta\in K$ — первообразный корень степени $N$. **ДПФ порядка $N$** — отображение

$$
\mathrm{DFT}_{N,\zeta}[K]:K^N\to K^N,\quad
(\gamma_i)_{i=0}^{N-1}\mapsto\big(\gamma_j^*\big)_{j=0}^{N-1},\quad \gamma_j^*=\sum_{i=0}^{N-1}\gamma_i\zeta^{ij}.
\tag{4}
$$

Если $N$ обратим в $K$, то $\mathrm{DFT}^{-1}_{N,\zeta}=N^{-1}\mathrm{DFT}_{N,\zeta^{-1}}$ (лемма о «почти‑обратимости»). Полиномиальная интерпретация: $\mathrm{DFT}$ изоморфно $K[x]/(x^N-1)\simeq K^N$, а, значит, **умножение «по модулю $x^N-1$» сводится к точечной свёртке**:
две прямые ДПФ + $N$ поэлементных умножений + одно обратное ДПФ.&#x20;

**Быстрое ПФ (БПФ)**: ключевые факты.

* Кули–Тьюки: $N=ST\Rightarrow$ ДПФ$(N)$ сводится к $S$ ДПФ$(T)$, $T$ ДПФ$(S)$ и $(S-1)(T-1)$ «поворотам» (twiddle). $\Rightarrow$ для $N=2^k$: $k2^k$ сложений/вычитаний и $(k-2)2^{k-1}+1$ умножений (асимптотически лучший известный счёт для степеней двойки).&#x20;
* Гуд–Томас (взаимно простые множители): никаких twiddle‑умножений.&#x20;
* Блюстайн (произвольный $N$): сводит ДПФ$(N)$ к циклической свёртке$(N)$ и $2N-2$ умножениям на корни. Лемма Блюстайна.&#x20;
* Рейдер (простое $N$): ДПФ$(N)$ $\to$ свёртка$(N-1)$+$2N-2$ сложений. Лемма Рейдера.&#x20;

Эти кирпичики понадобятся для целочисленного умножения через блочную свёртку.&#x20;

---

## 5) Умножение целых через БПФ: методы Шёнхаге–Штрассена (1971)

### 5.1. Комплексное приближение

Разобьём $N$-битовые числа на блоки длины $q$ и сведём к свёртке через **комплексное** ДПФ порядка $2^n$ (здесь $2N=2^n q$). Вычисления ведутся с $s$ битами точности так, чтобы каждый коэффициент результата восстанавливался округлением (ошибка $<\tfrac12$). Достаточно

$$
\boxed{\,s=2n+2q+\log n+O(1)\,}.
$$

Основной вклад — ДПФ: $O(2^n n)$ операций над $s$-битовыми числами, что приводит к рекуррентному неравенству

$$
M(N)\ \le\ O\!\big(2^n n\cdot(M(s)+s)\big)
$$

и **асимптотике**

$$
\boxed{\,M(N)=O\!\big(N\log N\log\log N\log\log\log N\cdots\big)\,}.
$$

(Такая же оценка ранее получалась Карацубой, но не была опубликована.)&#x20;

### 5.2. Кольцо‑расширение и «числа Ферма»

Чтобы уйти от численной ошибки, переходят к кольцам вида

$$
K_{2,n}(x)=K[x]/(x^{2^n}+1),
$$

в которых $x$ — корень нужного порядка; ДПФ порядка $2^{n+1}$ реализуется с очень дешёвыми умножениями на степени $x$ (фактически перестановки/сдвиги). Важны два факта:

* **Лемма 9.** ДПФ$(2^k)$ над $K_{2,n}$ (при $k\le n+1$) — за $k\,2^{k+n}$ аддитивных операций в $K$.&#x20;
* **Лемма 10 (изоморфизм).** $K_{2,n}(x)\simeq K_{2,m}(y)[x]/(x^{2^{\,n-m}}-y)$ (замена $x^{2^{\,n-m}}=y$). Это позволяет **рекурсивно уменьшать размер**.&#x20;

В результате:

* **Теорема 2.** Умножение в $K_{2,n}$ выполняется за $3\cdot 2^n n(\log_2 n+O(1))$ аддитивных операций и $O(n2^n)$ умножений в $K$.&#x20;

Для **целых** выбирают $K=\mathbb{Z}_{F_m}$, где $F_m=2^{2^m}+1$ (числа Ферма): «двойка» играет роль $x$. После вычислений коэффициенты исходного произведения восстанавливают по КТО (CRT), дополнив ещё одним модулем для безопасного диапазона коэффициентов. Итоговая асимптотика (по порядку та же, что в теореме 2):

$$
\boxed{\,M(n)=O(n\log n\log\log n)\,}.
$$

Практически близкий и простой вариант — схема Полларда: БПФ над $\mathbb{F}_{p_i}$ с $p_i\equiv 1\pmod{2^k}$ и восстановление по КТО; также полезны «взвешенные» преобразования Крандала–Фейгина для модулей $2^p-1$.&#x20;

---

## 6) После 2007 г.: к $O(n\log n)$

### 6.1. Fürer (2007/2009) и $p$-adic‑вариант (2013)

Рабочее кольцо:

$$
C_p=\mathbb{C}[x]/(x^{2^p}+1).
$$

В $C_p$ существуют «дешёвые» корни высокого **гладкого** порядка: строится многочлен $\rho_q(x)$ степени $<2^p$ со значениями $\rho_q(\zeta^{\,2k+1})=\xi^{\,2k+1}$ ($\zeta=e^{i\pi/2^p},\ \xi=e^{i\pi/(q2^p)}$) и с **ограниченными коэффициентами** у степеней $\rho_q^m(x)$. Это позволяет реализовать ДПФ порядка $N=2^{s(p+1)}$ так, что «дорогими» остаются только $s-1$ слоёв умножений на степени $\rho_{2^s}(x)$ (их **мало**), а внутренние ДПФ порядка $2^{p+1}$ реализуются сложениями/сдвигами. Пусть для хранения действительной и мнимой частей требуется $E$ бит. Тогда для умножения в $C_p[y]/(y^N-1)$:

$$
M(N,E)\ \le\ O(2^p E\,N\log N)\ +\ 3sN\cdot M(1,E),
$$

а умножение в $C_p$ сводится к умножению чисел длины $O(2^p(E+p))$. Подбор параметров

$$
E\asymp \log n,\quad 2^p\asymp \log n,\quad N\asymp \frac{n}{(\log n)^2},\quad s\asymp \frac{\log n}{\log\log n}
$$

даёт

$$
\boxed{\,M(n)\ \preceq\ n\log n\cdot 2^{O(\log^* n)}\,}.
$$

Имеется и модульная (p‑adic) версия с той же асимптотикой.&#x20;

### 6.2. Harvey–van der Hoeven–Lecerf (2014–2017)

Дальнейшее улучшение логарифмических сверхмножителей за счёт специальных коэффициентных колец (циклотомических), гладких порядков и аккуратной организации БПФ приводит к

$$
\boxed{\,M(n)=O\big(n\log n\cdot 4^{\log^* n}\big)\,}.
$$

Главный инженерный смысл — максимально «вынести стоимость» в хорошо управляемые малые преобразования и сократить число «дорогих» слоёв.&#x20;

### 6.3. Harvey–van der Hoeven (2019): $\boldsymbol{O(n\log n)}$

Идея: комбинировать **многомерное ДПФ** по взаимно простым модульным размерам с **приближённой редукцией порядков ДПФ** к степеням двойки (гладкие). Техническое ядро — матричное тождество

$$
\boxed{\,R\cdot \Pi_s\cdot \Phi_s\ =\ \Pi_t\cdot \Phi_t\cdot R'\,}
$$

(здесь $\Phi_z$ — матрица ДПФ порядка $z$, $\Pi$ — перестановки, $R,R'$ — специальные прямоугольные матрицы), позволяющее **вычислять ДПФ «плохого» порядка $s$** через ДПФ «хорошего» порядка $t$ **со стоимостью ниже $n\log n$** и контролируемой точностью (коэффициенты $R,R'$ быстро убывают вне «диагоналей»).

Структура параметров (схематически):

* Разбиваем вход на $N=O(n/\log n)$ блоков по $O(\log n)$ бит; работаем в $C_p=\mathbb{C}[y]/(y^{2^p}+1)$ с $p\sim \tfrac{1}{d}\log N$.
* Переводим к умножению в $C_p[x]/(x^{n_1\cdots n_{d-1}}-1)$ с взаимно простыми простыми $n_i$ и выбираем «близкие» степени двойки $t_i\in\{2^{p-1},2^{p}\}$, чтобы $t_1\cdots t_{d-1}$ чуть превосходил $n_1\cdots n_{d-1}$.
* **Сводим** многомерное ДПФ порядка $n_1\times\cdots\times n_{d-1}$ к порядку $t_1\times\cdots\times t_{d-1}$, где БПФ реализуется за $O(N'\log N'\cdot 2^pE)=O(n\log n)$ ( $E=O(\log n)$ — точность на коэффициент).

Получается ключевое неравенство

$$
\boxed{\,M(n)\ \le\ M(N',E)+O(n)\ \le\ N'\cdot M(1,E)+O(n\log n)\,}
\tag{8}
$$

с $N'=O\!\big(n\cdot 2^{-p}/\log n\big)$ и $p\approx \tfrac{1}{d}\log n$. При достаточно большом константном $d$ отсюда следует

$$
\boxed{\,M(n)=O(n\log n)\,}.
$$

По мнению авторов обзора, по порядку это, вероятно, **предел** в битовой модели.&#x20;

---

## 7) Параллельная глубина, on‑line и модели вычислений

### 7.1. Глубина умножения через компрессоры

Параллельное «свёртывание столбиков» частичных сумм компрессорами $(k,\ell)$ (carry‑save) даёт

$$
\boxed{\,D(M_n)\ \le\ D(C_n)+\log n+o(\log n)\,}
\tag{10}
$$

(где $C_n$ — оператор суммирования $n$ бит), поэтому **глубина** $D(M_n)=O(\log n)$. Лучшие известные верхние оценки (схемы): конструктивно $D(M_n)\lesssim 4.34\log n$, неконструктивно $\lesssim 4.02\log n$.&#x20;

### 7.2. Умножение «в реальном времени» (on‑line)

Для on‑line‑модели (каждый $k$-й входной бит доступен лишь после вычисления $(k-1)$-го бита результата) известно:

$$
\boxed{\,M_{\text{online}}(2^k)\ \preceq\ \sum_{i=0}^{k-1} 2^{k-i}\,M(2^i)+k\,2^k\,}
$$

и, следовательно, $M_{\text{online}}(n)\preceq M(n)\log n$; при этом нижняя граница $\Omega(n\log n)$.&#x20;

### 7.3. Про модели, где «квадратика» и где «линейка»

* **Клеточные схемы** (плоские/3D): неизбежно $\Theta(n^2)$ для умножения — по счёту «проводников» и локальности соединений.&#x20;
* **log‑RAM / машины с указателями**: методы типа Шёнхаге–Штрассена дают **линейную** во входе сложность (аргументы длины $\Theta(\log n)$ считаются за $O(1)$). Это свойство модели, а не битовой сложности.&#x20;

---

## 8) Уточнённые константы в базовых методах

* **Стандартный метод**: благодаря новым компрессорам верхняя оценка сложности уточняется до

$$
\boxed{\,5.5\,n^2-6.5\,n-1+(n\bmod 2)\,}.
$$

* **Карацуба**: при учёте стоимости сложений/вычитаний из (K) для размеров $2^k$

$$
\boxed{\,K(2^k)\ \le\ \frac{2583}{405}\,3^k\ -\ O(2^k)\,}.
$$

Эти оценки важны при оптимальных порогах переключения между методами в реальных библиотеках (GMP и др.).&#x20;

---

## 9) Карта результатов (целые числа) — сводка асимптотик

* «Школьный»: $M(n)=\Theta(n^2)$ (улучшенные константы см. выше).&#x20;
* Карацуба: $M(n)=O\!\big(n^{\log_2 3}\big)\approx O(n^{1.585})$.&#x20;
* Тоом–Кук (теоретически, при росте $r$): субквадратично, вплоть до $O\!\big(\frac{n^2}{\sqrt{\log n}\,\log n}\big)$ в классических оценках; на практике берут малые $r$.&#x20;
* Шёнхаге–Штрассен (комплекс): $O(n\log n\log\log n\log\log\log n\cdots)$.&#x20;
* Шёнхаге–Штрассен (кольца/Ферма): $O(n\log n\log\log n)$.&#x20;
* Fürer (и p‑adic): $O\!\big(n\log n\cdot 2^{O(\log^* n)}\big)$.&#x20;
* Harvey–vdH–Lecerf: $O\!\big(n\log n\cdot 4^{\log^* n}\big)$.&#x20;
* Harvey–vdH (2019): $\boxed{O(n\log n)}$ — текущий теоретический рекорд для целых; по порядку, вероятно, предел.&#x20;

---

## 10) Ключевые математические элементы и эскизы доказательств

1. **Решение рекуррентности Карацубы.** $K(2n)\le 3K(n)+cn\Rightarrow K(n)=O(n^{\log_2 3})$, т.к. $n^{\log_2 3}$ доминирует над $n$.&#x20;

2. **ДПФ как изоморфизм колец.** $\mathrm{DFT}_{N,\zeta}$ реализует $K[x]/(x^N-1)\simeq K^N$; две прямые ДПФ + покомпонентные умножения + обратная ДПФ = умножение по модулю $x^N-1$ (циклическая свёртка).&#x20;

3. **Комплексный SS: выбор точности.** Для восстановления целых коэффициентов округлением достаточно $s=2n+2q+\log n+O(1)$ двоичных знаков: это гарантирует накопленную абсолютную ошибку $<\tfrac12$ на каждом коэффициенте после обратной ДПФ. Дальше — развёртывание рекурсии даёт иерархию логарифмов.&#x20;

4. **Кольцевой SS: дёшево умножать на степени $x$.** В $K_{2,n}$ «twiddle»‑умножения — это сдвиги/перестановки, см. лемму 9; изоморфизм леммы 10 даёт логарифмическое число уровней редукции размера. Итог: $O(n\log n\log\log n)$.&#x20;

5. **Fürer: мало «дорогих» слоёв.** В БПФ порядка $2^{s(p+1)}$ «дорогих» слоёв $\sim s$, а $s\sim \log n/\log\log n$; внутренняя работа — сложения/сдвиги. При $E\asymp\log n,\ 2^p\asymp\log n$ получается $n\log n\cdot 2^{O(\log^* n)}$.&#x20;

6. **$O(n\log n)$ 2019: приближение ДПФ «плохого» порядка.** Построение $R,\Pi,\Phi$ даёт переопределённую систему $A X=b$ для $X=\Phi_s x$ с хорошими численно‑аналитическими свойствами (быстрое убывание коэффициентов). Сведение многомерного ДПФ к степеням 2 выполняется **со стоимостью $o(n\log n)$**, остальная работа — $O(n\log n)$. Неравенство (8) замыкает оценку.&#x20;

7. **Глубина: компрессоры.** Многократное сложение $n$ слагаемых сводится к $O(\log n)$ уровням $(k,\ell)$‑компрессоров плюс финальный сумматор глубины $O(\log n)$ $\Rightarrow$ $D(M_n)\le D(C_n)+\log n+o(\log n)$.&#x20;

8. **On‑line:** по Фишеру–Стокмайеру

$$
M_{\text{online}}(2^k)\preceq \sum_{i=0}^{k-1}2^{k-i}M(2^i)+k2^k\Rightarrow M_{\text{online}}(n)\preceq M(n)\log n,
$$

при этом низ $\Omega(n\log n)$.&#x20;

---

## 11) Практические ремарки (где что включать)

* До «десятков–сотен» бит — стандарт/Карацуба/малые Тоомы; «тысячи» и выше — схемы семейства SS; «миллионы цифр» — FFT‑семейство с тщательным контролем точности/модулей. Выбор зависит от разрядности и постоянных.&#x20;

---

## 12) Выводы

1. С 1962 по 2019 г. центральная идея — **интерполяция/свёртка** через корни из единицы и специально подобранные кольца — довела сложность целочисленного умножения от $O(n^2)$ до $\boxed{O(n\log n)}$. По порядку это, с высокой вероятностью, **предел** в битовой модели.&#x20;
2. Для параллельного времени $D(M_n)$ достигнут логарифмический порядок; on‑line‑сложность не может быть лучше $\Omega(n\log n)$.&#x20;
3. Для практики решают **пороговые переключения** и **константы**; улучшения констант даже у «квадратичных»/Карацубы существенны.&#x20;
